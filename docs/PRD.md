# **차량 배차 경로 시각화 시스템 PRD**

## **프로젝트 개요**

**프로젝트 이름:** 차량 배차 경로 시각화 시스템  
**목적:**  
차량 배차 경로를 Openstreetmap과 Openlayers를 활용하여 시각화하고, 창고와 가게의 위치를 직관적으로 표시합니다. 마커에는 방문 순서를 표시하며, 사용자가 마커를 클릭하면 팝업을 통해 상세 정보를 확인할 수 있습니다. 초기 단계에서는 프로젝트 내부의 JSON 파일을 읽어 경로를 시각화합니다.

---

## **유저 플로우**

1. **JSON 데이터 로드**

   - 프로젝트 내부에 저장된 `route-input.json` 파일을 읽어 경로 데이터를 로드합니다.
   - JSON 파일에는 각 라우트의 정보(차량 ID, 차량 유형, 경로 색상, 출발 창고 및 가게 정보)가 포함되어 있습니다.

2. **경로 시각화**

   - JSON 데이터를 기반으로 Openlayers와 Openstreetmap을 활용해 지도에 경로를 표시합니다.
   - 각 라우트는 지정된 색상으로 구분됩니다.

3. **마커 표시**

   - 창고와 가게 위치는 서로 다른 마커 스타일로 구분됩니다.
   - 마커에는 방문 순서가 숫자로 표시됩니다.

4. **마커 이동 기능 (제약 사항 포함)**

   - 창고 마커는 고정되어 이동할 수 없습니다.
   - 가게 마커는 동일한 경로 내에서 이동할 수 없으며, 다른 경로로만 이동 가능합니다.
   - 마커가 다른 경로로 이동하면:
     - 기존 라우트에서 해당 마커가 제거됩니다.
     - 새로운 라우트에 해당 마커가 추가됩니다.
     - 두 라우트의 데이터 및 지도 상의 경로가 실시간으로 업데이트됩니다.

5. **팝업 기능**

   - 사용자가 마커를 클릭하면 팝업이 생성되어 해당 위치의 세부 정보(예: 이름, 위치 ID, 유형 등)를 표시합니다.
   - 팝업은 닫기 버튼을 통해 닫을 수 있습니다.

6. **UI 인터페이스**
   - 지도 상단에 경로 필터링 옵션(차량 ID 또는 차량 유형별)을 제공합니다.
   - 경로 데이터 요약(차량 ID, 경로 길이 등)을 사이드바에 표시합니다.

---

## **기술 스택**

### **필수 기술 스택**

- **Vue 2:** 프론트엔드 프레임워크
- **Openlayers:** 지도 및 경로 시각화를 위한 라이브러리
- **Openstreetmap:** 지도 데이터 제공
- 상태 관리는 vuex가 아니라 props, emit 방식으로 App.vue에서 관리

---

## **MVP 기능 개발**

### 1. **JSON 데이터 로드**

- 프로젝트 내부의 `route-input.json` 파일을 읽어 Vue 상태 관리에 저장.
- JSON 구조:

```
{
"routes": [
    {
        "id": "route1",
        "vehicle_id": "v001",
        "vehicle_type": "truck",
        "color": "#FF0000",
        "path": [
            { "name": "Warehouse A", "location_id": "w1", "lat": 37.5665, "lng": 126.9780, "is_warehouse": true },
            { "name": "Store B", "location_id": "s1", "lat": 37.5651, "lng": 126.9895, "is_customer": true }
        ]
        }
    ]
}
```

### 2. **지도 렌더링**

- Openlayers와 Openstreetmap을 연동하여 기본 지도를 렌더링.
- 지도 초기 확대/축소 레벨 설정.

### 3. **경로 시각화**

- JSON 데이터를 기반으로 각 라우트의 경로를 지정된 색상으로 지도에 표시.
- GeoJSON 형식으로 변환하여 Openlayers에 추가.

### 4. **마커 표시 및 스타일링**

- 창고와 가게의 마커를 구분하여 표시:
- 창고: 파란색 원형 마커
- 가게: 빨간색 핀 모양 마커
- 각 마커에는 방문 순서를 숫자로 표시:
- 예: `1`, `2`, `3` 등.

### 5. **마커 이동 기능 (제약 사항 반영)**

- 드래그 앤 드롭을 통해 가게 마커 위치 조정 가능:
- 창고 마커는 고정되어 이동 불가능.
- 가게 마커는 동일한 라우트 내에서 이동할 수 없으며, 다른 라우트로만 이동 가능.
  - 기존 라우트에서 해당 마커 제거.
  - 새로운 라우트에 해당 마커 추가.
  - 두 라우트의 데이터 및 지도 상의 경로가 실시간으로 업데이트.

### 6. **팝업 기능**

- 사용자가 마커를 클릭하면 팝업이 생성되어 해당 위치의 세부 정보를 표시:
- 팝업 내용 예시: `이름: Store B`, `위치 ID: s1`, `유형: 고객`.
- 팝업은 Openlayers의 `ol/Overlay` 객체를 사용하여 구현하며, 닫기 버튼 포함.

### 7. **UI 구성**

- JSON 데이터 로드 버튼 제거 (프로젝트 내부 파일 사용).
- 차량 ID 또는 유형별 필터링 옵션 제공.
- 사이드바에 경로 요약 정보 표시.

---

## **MVP 기능 개발 이후 추가 개선 사항**

1. **경로 최적화 알고리즘**

- 차량 경로 최적화를 위한 알고리즘 추가 (예: Dijkstra 또는 A\* 알고리즘).

2. **실시간 데이터 연동**

- API 연동을 통해 실시간 차량 위치 및 상태 업데이트.

3. **사용자 권한 관리**

- 관리자와 일반 사용자를 구분하여 권한 기반 기능 제공.

4. **다국어 지원**

- 글로벌 사용자를 위한 다국어 인터페이스 추가.

5. **데이터 분석 대시보드**

- 경로 효율성, 차량 이용률 등의 데이터를 시각화하는 대시보드 개발.

6. **오프라인 모드 지원**

- 인터넷 연결이 없는 상황에서도 기본적인 지도 탐색 가능하도록 구현.

---

이 PRD는 방문 순서 표시와 팝업 생성 요구사항을 반영했으며, 핵심 기능 구현에 중점을 두었습니다.
